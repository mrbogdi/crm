<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>mrbogdi - home</title>

<!-- Fluent UI Web Components -->
<script type="module" src="https://unpkg.com/@fluentui/web-components@latest/dist/fluent-components.min.js"></script>

<!-- CryptoJS AES -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js" integrity="sha512-GOJEixx70jjrfV5FVknlVbMT1W9Kv5ZvK4Zsm6Ha7TJWCE5AXv9dE44vqVtDb9L7KOPJz1XuzFwLPF0az1w0Uw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<!-- Chart.js for advanced charts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
  /* Reset & base */
  :root {
    --primary-color: #0078D4;
    --success-color: #4caf50;
    --error-color: #e81123;
    --background-light: #f3f3f3;
    --background-dark: #1e1e1e;
    --text-light: #333;
    --text-dark: #f3f3f3;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    --fluent-accent-fill-rest: var(--primary-color);
  }
  html, body {
    margin: 0; padding: 0;
    height: 100%;
    background-color: var(--background-light);
    color: var(--text-light);
    display: flex;
    font-size: 16px;
  }
  body.dark {
    background-color: var(--background-dark);
    color: var(--text-dark);
  }

  /* Layout */
  aside {
    background: white;
    border-right: 1px solid #ccc;
    width: 72px;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1rem 0;
    box-sizing: border-box;
    position: relative;
  }
  body.dark aside {
    background: #252525;
    border-color: #444;
  }
  aside fluent-button {
    width: 44px;
    height: 44px;
    margin: 0.4rem 0;
    font-size: 22px;
  }
  aside #encryptedInfo {
    position: absolute;
    bottom: 1rem;
    left: 50%;
    transform: translateX(-50%);
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--success-color);
    cursor: help;
    display: flex;
    align-items: center;
    gap: 0.3rem;
  }
  main {
    flex-grow: 1;
    overflow-y: auto;
    padding: 1rem 2rem;
    min-width: 0;
  }
  h2 {
    margin: 0 0 1rem 0;
    font-weight: 700;
  }
  .top-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
  }
  /* Tabs and content */
  .tabcontent {
    display: none;
  }
  .tabcontent.active {
    display: block;
  }
  fluent-text-field, fluent-select, fluent-button {
    width: 100%;
    max-width: 400px;
    margin-bottom: 1rem;
  }
  fluent-text-field[required]::part(control) {
    border-color: var(--primary-color);
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 0.5rem;
  }
  th, td {
    text-align: left;
    padding: 0.6rem 0.75rem;
    border-bottom: 1px solid #ddd;
    vertical-align: middle;
  }
  body.dark th, body.dark td {
    border-color: #444;
  }
  th {
    background-color: var(--primary-color);
    color: white;
    font-weight: 600;
  }
  body.dark th {
    background-color: #106ebe;
  }
  tr:hover {
    background-color: #f0f7ff;
  }
  body.dark tr:hover {
    background-color: #2a3b57;
  }

  /* License cards */
  .license-list {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-top: 1rem;
  }
  .license-card {
    background: var(--background-light);
    border-radius: 8px;
    padding: 1rem 1.5rem;
    box-shadow: 0 2px 6px rgb(0 0 0 / 0.15);
    flex: 1 1 200px;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-weight: 600;
    color: var(--text-light);
    user-select: none;
  }
  body.dark .license-card {
    background: #333;
    color: var(--text-dark);
    box-shadow: 0 2px 6px rgb(255 255 255 / 0.1);
  }
  .license-card svg {
    width: 24px;
    height: 24px;
    fill: var(--success-color);
  }

  /* Tooltip */
  .tooltip {
    position: relative;
    display: inline-block;
  }
  .tooltip .tooltiptext {
    visibility: hidden;
    width: 220px;
    background-color: #333;
    color: #fff;
    text-align: center;
    border-radius: 6px;
    padding: 0.5rem;
    position: absolute;
    z-index: 10;
    bottom: 125%;
    left: 50%;
    transform: translateX(-50%);
    opacity: 0;
    transition: opacity 0.3s ease;
    font-size: 0.85rem;
    pointer-events: none;
  }
  .tooltip:hover .tooltiptext, .tooltip:focus .tooltiptext {
    visibility: visible;
    opacity: 1;
    pointer-events: auto;
  }

  /* Buttons */
  fluent-button[appearance="accent"] {
    --button-accent-fill-rest: var(--primary-color);
    --button-accent-fill-hover: #005a9e;
    --button-accent-fill-active: #004578;
  }

  /* Responsive */
  @media (max-width: 720px) {
    aside {
      width: 48px;
    }
    aside fluent-button {
      width: 32px;
      height: 32px;
      font-size: 18px;
      margin: 0.25rem 0;
    }
    fluent-text-field, fluent-select, fluent-button {
      max-width: 100%;
    }
  }

</style>

<body>
  <aside role="navigation" aria-label="Meniu principal CRM">
    <fluent-button title="Clien»õi" aria-pressed="true" id="btn-clienti" onclick="switchTab('clienti')" >üìá</fluent-button>
    <fluent-button title="Contracte" id="btn-contracte" onclick="switchTab('contracte')">üìÑ</fluent-button>
    <fluent-button title="Abonamente" id="btn-abonamente" onclick="switchTab('abonamente')">üì¶</fluent-button>
    <fluent-button title="Tracking HR" id="btn-hr" onclick="switchTab('hr')">üë•</fluent-button>
    <fluent-button title="Licen»õe" id="btn-licente" onclick="switchTab('licente')">üîë</fluent-button>
    <fluent-button title="Dashboard" id="btn-dashboard" onclick="switchTab('dashboard')">üìä</fluent-button>

    <fluent-button appearance="accent" title="ExportƒÉ date criptate" onclick="exportData()">‚¨áÔ∏è</fluent-button>
    <fluent-button title="ImportƒÉ date criptate" onclick="importData()">‚¨ÜÔ∏è</fluent-button>
    <fluent-button appearance="stealth" title="ReseteazƒÉ toate datele" onclick="clearData()">üóëÔ∏è</fluent-button>

    <div id="encryptedInfo" class="tooltip" tabindex="0" role="note" aria-label="Datele sunt stocate criptat folosind AES-256 cu PIN">
      <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="currentColor">
        <path d="M12 1C8.13 1 5 4.13 5 8v4H4a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1h-1V8c0-3.87-3.13-7-7-7zm0 3a3 3 0 0 1 3 3v4h-6V7a3 3 0 0 1 3-3zm-1 8v5h2v-5h-2z"/>
      </svg>
      Date criptate AES-256
      <span class="tooltiptext">Toate datele sunt stocate »ôi transferate folosind criptare AES-256 cu salt »ôi PIN. Siguran»õa datelor este prioritarƒÉ.</span>
    </div>
  </aside>

  <main>
    <div class="top-bar">
      <h1>CRM Enterprise - Nivel maxim de securitate</h1>
      <fluent-button id="toggleDarkMode">Mod √éntunecat</fluent-button>
    </div>

    <!-- Tab Clien»õi -->
    <section id="clienti" class="tabcontent active" aria-labelledby="tab-clienti" role="tabpanel">
      <h2>Administrare Clien»õi</h2>
      <form id="clientForm" aria-label="Formular adƒÉugare client">
        <fluent-text-field id="clientName" placeholder="Nume client" required aria-required="true"></fluent-text-field>
        <fluent-text-field id="clientEmail" placeholder="Email client" type="email" required aria-required="true"></fluent-text-field>
        <fluent-button appearance="accent" type="submit">AdaugƒÉ Client</fluent-button>
      </form>
      <table aria-label="Lista clien»õi">
        <thead><tr><th>Nume</th><th>Email</th></tr></thead>
        <tbody id="clientList"></tbody>
      </table>
    </section>

    <!-- Tab Contracte -->
    <section id="contracte" class="tabcontent" aria-labelledby="tab-contracte" role="tabpanel" hidden>
      <h2>Administrare Contracte</h2>
      <form id="contractForm" aria-label="Formular adƒÉugare contract">
        <fluent-select id="contractClient" required aria-required="true" placeholder="SelecteazƒÉ client">
          <option value="" disabled selected>SelecteazƒÉ client</option>
        </fluent-select>
        <fluent-text-field id="contractName" placeholder="Nume contract" required aria-required="true"></fluent-text-field>
        <fluent-button appearance="accent" type="submit">AdaugƒÉ Contract</fluent-button>
      </form>
      <table aria-label="Lista contracte">
        <thead><tr><th>Client</th><th>Contract</th></tr></thead>
        <tbody id="contractList"></tbody>
      </table>
    </section>

    <!-- Tab Abonamente -->
    <section id="abonamente" class="tabcontent" aria-labelledby="tab-abonamente" role="tabpanel" hidden>
      <h2>Administrare Abonamente</h2>
      <form id="abonamentForm" aria-label="Formular adƒÉugare abonament">
        <fluent-select id="abonamentClient" required aria-required="true" placeholder="SelecteazƒÉ client">
          <option value="" disabled selected>SelecteazƒÉ client</option>
        </fluent-select>
        <fluent-text-field id="abonamentName" placeholder="Nume abonament" required aria-required="true"></fluent-text-field>
        <fluent-select id="abonamentStatus" required aria-required="true" placeholder="Status">
          <option value="" disabled selected>SelecteazƒÉ status</option>
          <option value="activ">Activ</option>
          <option value="inactiv">Inactiv</option>
          <option value="anulat">Anulat</option>
        </fluent-select>
        <fluent-button appearance="accent" type="submit">AdaugƒÉ Abonament</fluent-button>
      </form>
      <table aria-label="Lista abonamente">
        <thead><tr><th>Client</th><th>Abonament</th><th>Status</th></tr></thead>
        <tbody id="abonamentList"></tbody>
      </table>
    </section>

    <!-- Tab HR -->
    <section id="hr" class="tabcontent" aria-labelledby="tab-hr" role="tabpanel" hidden>
      <h2>Tracking HR</h2>
      <form id="hrForm" aria-label="Formular adƒÉugare angajat">
        <fluent-text-field id="employeeName" placeholder="Nume angajat" required aria-required="true"></fluent-text-field>
        <fluent-select id="employeeRole" required aria-required="true" placeholder="Rol angajat">
          <option value="" disabled selected>SelecteazƒÉ rol</option>
          <option value="manager">Manager</option>
          <option value="developer">Developer</option>
          <option value="sales">Sales</option>
          <option value="support">Support</option>
        </fluent-select>
        <fluent-button appearance="accent" type="submit">AdaugƒÉ Angajat</fluent-button>
      </form>
      <table aria-label="Lista angaja»õi">
        <thead><tr><th>Nume</th><th>Rol</th></tr></thead>
        <tbody id="employeeList"></tbody>
      </table>
    </section>

    <!-- Tab Licen»õe -->
    <section id="licente" class="tabcontent" aria-labelledby="tab-licente" role="tabpanel" hidden>
      <h2>Administrare Licen»õe</h2>
      <form id="licenseForm" aria-label="Formular generare licen»õƒÉ" style="display:flex; gap:1rem; flex-wrap: wrap; align-items: center;">
        <fluent-text-field id="licenseGenInput" placeholder="Nume client pentru licen»õƒÉ" required aria-required="true" style="flex:1 1 250px;"></fluent-text-field>
        <fluent-button appearance="accent" type="submit">GenereazƒÉ Licen»õƒÉ</fluent-button>
      </form>
      <div class="license-list" id="licenseList" aria-live="polite" aria-relevant="additions" role="list"></div>
    </section>

    <!-- Tab Dashboard -->
    <section id="dashboard" class="tabcontent" aria-labelledby="tab-dashboard" role="tabpanel" hidden>
      <h2>Dashboard Statistici Avansate</h2>
      <canvas id="statsChart" aria-label="Grafic statistici CRM" role="img" style="max-width: 100%; height: 400px;"></canvas>
    </section>
  </main>

<script>
  // Utilitare criptare AES cu CryptoJS
  const SECRET_PIN = '1234SecurePin!'; // √én produc»õie, pinul ar fi securizat altfel

  function encryptData(data) {
    return CryptoJS.AES.encrypt(JSON.stringify(data), SECRET_PIN).toString();
  }

  function decryptData(ciphertext) {
    try {
      const bytes = CryptoJS.AES.decrypt(ciphertext, SECRET_PIN);
      return JSON.parse(bytes.toString(CryptoJS.enc.Utf8));
    } catch (e) {
      return null;
    }
  }

  // Date stocate local
  let clienti = [];
  let contracte = [];
  let abonamente = [];
  let angajati = [];
  let licente = [];

  // Initializare aplica»õie
  document.addEventListener('DOMContentLoaded', () => {
    loadData();
    setupEventListeners();
    renderAllLists();
    setupChart();
  });

  // Load & Save localStorage (criptat)
  function loadData() {
    const encryptedClients = localStorage.getItem('crm_clienti');
    if(encryptedClients) {
      const data = decryptData(encryptedClients);
      if(data) clienti = data;
    }
    const encryptedContracte = localStorage.getItem('crm_contracte');
    if(encryptedContracte) {
      const data = decryptData(encryptedContracte);
      if(data) contracte = data;
    }
    const encryptedAbonamente = localStorage.getItem('crm_abonamente');
    if(encryptedAbonamente) {
      const data = decryptData(encryptedAbonamente);
      if(data) abonamente = data;
    }
    const encryptedAngajati = localStorage.getItem('crm_angajati');
    if(encryptedAngajati) {
      const data = decryptData(encryptedAngajati);
      if(data) angajati = data;
    }
    const encryptedLicente = localStorage.getItem('crm_licente');
    if(encryptedLicente) {
      const data = decryptData(encryptedLicente);
      if(data) licente = data;
    }
  }

  function saveData() {
    localStorage.setItem('crm_clienti', encryptData(clienti));
    localStorage.setItem('crm_contracte', encryptData(contracte));
    localStorage.setItem('crm_abonamente', encryptData(abonamente));
    localStorage.setItem('crm_angajati', encryptData(angajati));
    localStorage.setItem('crm_licente', encryptData(licente));
  }

  // Switch tab
  function switchTab(tabId) {
    document.querySelectorAll('.tabcontent').forEach(t => {
      t.classList.remove('active');
      t.hidden = true;
    });
    document.getElementById(tabId).classList.add('active');
    document.getElementById(tabId).hidden = false;

    // Active button highlight
    document.querySelectorAll('aside fluent-button').forEach(btn => btn.setAttribute('aria-pressed', 'false'));
    document.getElementById('btn-' + tabId).setAttribute('aria-pressed', 'true');

    // Update selects when switching tabs
    if (tabId === 'contracte') populateClientSelect('contractClient');
    if (tabId === 'abonamente') populateClientSelect('abonamentClient');
  }

  // Populare select client
  function populateClientSelect(selectId) {
    const select = document.getElementById(selectId);
    select.innerHTML = `<option value="" disabled selected>SelecteazƒÉ client</option>`;
    clienti.forEach(c => {
      const option = document.createElement('option');
      option.value = c.email;
      option.textContent = c.name;
      select.appendChild(option);
    });
  }

  // Render liste
  function renderAllLists() {
    renderClientList();
    renderContractList();
    renderAbonamentList();
    renderEmployeeList();
    renderLicenseList();
    updateDashboard();
  }

  function renderClientList() {
    const tbody = document.getElementById('clientList');
    tbody.innerHTML = '';
    clienti.forEach(c => {
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${escapeHtml(c.name)}</td><td>${escapeHtml(c.email)}</td>`;
      tbody.appendChild(tr);
    });
  }
  function renderContractList() {
    const tbody = document.getElementById('contractList');
    tbody.innerHTML = '';
    contracte.forEach(ct => {
      const clientName = clienti.find(c => c.email === ct.clientEmail)?.name || 'Necunoscut';
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${escapeHtml(clientName)}</td><td>${escapeHtml(ct.name)}</td>`;
      tbody.appendChild(tr);
    });
  }
  function renderAbonamentList() {
    const tbody = document.getElementById('abonamentList');
    tbody.innerHTML = '';
    abonamente.forEach(ab => {
      const clientName = clienti.find(c => c.email === ab.clientEmail)?.name || 'Necunoscut';
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${escapeHtml(clientName)}</td><td>${escapeHtml(ab.name)}</td><td>${escapeHtml(ab.status)}</td>`;
      tbody.appendChild(tr);
    });
  }
  function renderEmployeeList() {
    const tbody = document.getElementById('employeeList');
    tbody.innerHTML = '';
    angajati.forEach(e => {
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${escapeHtml(e.name)}</td><td>${escapeHtml(e.role)}</td>`;
      tbody.appendChild(tr);
    });
  }

  // Licen»õe - afi»ôare √Æn carduri
  function renderLicenseList() {
    const container = document.getElementById('licenseList');
    container.innerHTML = '';
    licente.forEach(l => {
      const card = document.createElement('div');
      card.className = 'license-card';
      card.setAttribute('role', 'listitem');
      card.innerHTML = `
        <svg aria-hidden="true" focusable="false" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 1C8.13 1 5 4.13 5 8v4H4a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1h-1V8c0-3.87-3.13-7-7-7zm0 3a3 3 0 0 1 3 3v4h-6V7a3 3 0 0 1 3-3zm-1 8v5h2v-5h-2z"/>
        </svg>
        <span>${escapeHtml(l.client)} - <code>${escapeHtml(l.key)}</code></span>
      `;
      container.appendChild(card);
    });
  }

  // Formulare adƒÉugare
  function setupEventListeners() {
    // Clien»õi
    document.getElementById('clientForm').addEventListener('submit', e => {
      e.preventDefault();
      const name = e.target.clientName.value.trim();
      const email = e.target.clientEmail.value.trim();
      if (!name || !email) return alert('Completati toate campurile clientului!');
      if (clienti.some(c => c.email === email)) return alert('Client cu acest email existƒÉ deja!');
      clienti.push({name, email});
      saveData();
      renderClientList();
      populateClientSelect('contractClient');
      populateClientSelect('abonamentClient');
      e.target.reset();
      updateDashboard();
    });

    // Contracte
    document.getElementById('contractForm').addEventListener('submit', e => {
      e.preventDefault();
      const clientEmail = e.target.contractClient.value;
      const name = e.target.contractName.value.trim();
      if (!clientEmail || !name) return alert('Completa»õi toate c√¢mpurile contractului!');
      contracte.push({clientEmail, name});
      saveData();
      renderContractList();
      e.target.reset();
      updateDashboard();
    });

    // Abonamente
    document.getElementById('abonamentForm').addEventListener('submit', e => {
      e.preventDefault();
      const clientEmail = e.target.abonamentClient.value;
      const name = e.target.abonamentName.value.trim();
      const status = e.target.abonamentStatus.value;
      if (!clientEmail || !name || !status) return alert('Completa»õi toate c√¢mpurile abonamentului!');
      abonamente.push({clientEmail, name, status});
      saveData();
      renderAbonamentList();
      e.target.reset();
      updateDashboard();
    });

    // HR
    document.getElementById('hrForm').addEventListener('submit', e => {
      e.preventDefault();
      const name = e.target.employeeName.value.trim();
      const role = e.target.employeeRole.value;
      if (!name || !role) return alert('Completa»õi toate c√¢mpurile angajatului!');
      angajati.push({name, role});
      saveData();
      renderEmployeeList();
      e.target.reset();
    });

    // Licen»õe
    document.getElementById('licenseForm').addEventListener('submit', e => {
      e.preventDefault();
      const clientName = e.target.licenseGenInput.value.trim();
      if (!clientName) return alert('Completa»õi numele clientului pentru licen»õƒÉ!');
      const licenseKey = generateLicenseKey(clientName);
      licente.push({client: clientName, key: licenseKey});
      saveData();
      renderLicenseList();
      e.target.reset();
    });

    // Toggle mod √Æntunecat
    document.getElementById('toggleDarkMode').addEventListener('click', () => {
      document.documentElement.classList.toggle('dark-mode');
    });

    // Tab buttons
    document.querySelectorAll('aside fluent-button').forEach(btn => {
      btn.addEventListener('click', () => {
        const tabId = btn.id.replace('btn-', '');
        switchTab(tabId);
      });
    });
  }

  // Generare licen»õƒÉ simplƒÉ (hash)
  function generateLicenseKey(clientName) {
    // Simplu hash bazat pe clientName + data curentƒÉ
    const data = clientName + new Date().toISOString();
    return CryptoJS.SHA256(data).toString().slice(0, 16).toUpperCase();
  }

  // Escapare HTML simplƒÉ
  function escapeHtml(text) {
    const map = {
      '&': '&amp;',
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&#039;'
    };
    return text.replace(/[&<>"']/g, m => map[m]);
  }

  // Dashboard (exemplu grafic Chart.js)
  let statsChart;
  function setupChart() {
    const ctx = document.getElementById('statsChart').getContext('2d');
    statsChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['Clien»õi', 'Contracte', 'Abonamente', 'Angaja»õi', 'Licen»õe'],
        datasets: [{
          label: 'NumƒÉr entitƒÉ»õi',
          data: [clienti.length, contracte.length, abonamente.length, angajati.length, licente.length],
          backgroundColor: ['#0078D4', '#2B88D8', '#71AFE5', '#A4C8F0', '#C7E0F4']
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: { beginAtZero: true }
        }
      }
    });
  }

  function updateDashboard() {
    if (statsChart) {
      statsChart.data.datasets[0].data = [clienti.length, contracte.length, abonamente.length, angajati.length, licente.length];
      statsChart.update();
    }
  }
</script>
</body>
</html>
